<script type="text/javascript">
	
	init_jqgrid();

	function init_jqgrid(){
		// 列名の定義
		var col_names = ["支店", "営業所", "レンターズ掲載数", "SUUMOハイライト","リンク"];
	
		// 列属性の定義
		var col_model = [
	  	  {name:"group_name", index:"group_name", align:"center",classes:"no_class"}
		 ,{name:"store_name", index:"store_name", align:"center",classes:"no_class"}
		 ,{name:"summary", index:"summary", align:"center",classes:"no_class",summaryType:'sum', summaryTpl : '合計 : {0}'}
		 ,{name:"suumo_highlite", index:"suumo_highlite", align:"center",classes:"no_class",summaryType:'sum', summaryTpl : '合計 : {0}'}
 		 ,{name:"url", index:"map_link", width:200, align:"center", classes:"no_class", formatter: 'link'}
		];
	

		// その他の設定
		jqgrid_opt = {
			 table_name:'building_table'
			,fotter_name:'building_pager'
			,div_name:'div_dummy_02'
			,caption:'レンターズ掲載状況' 
			,event_type:30
			,shrinkFit:true
			,multiselect:true
		};
		
		// jqgrid作成
		$(function(){
			
			var table_div = $('#' + jqgrid_opt.table_name);
			var div_box = $('#' + jqgrid_opt.div_name);
	
			table_div.jqGrid({
			  	data : gon.data_list,  //表示したいデータ
			  	datatype : "local",            //データの種別 他にjsonやxmlも選べます。しかし、私はlocalが推奨です。
			  	colNames : col_names,           //列の表示名
			  	colModel : col_model,   //列ごとの設定
			  	caption : jqgrid_opt.caption,    //ヘッダーのキャプション
			  	rowNum : 100,                   //一ページに表示する行数
				height : 800,                  //高さ
			  	shrinkToFit : true,　　        //画面サイズに依存せず固定の大きさを表示する設定
				pager : 'building_pager',
				viewrecords: true,
				grouping:true,                    //グルーピングon
				groupingView : {                  //グルーピング設定
					groupField : ['group_name'],     //グループする列指
			　　　　        groupSummary : [true]
				}				
			});
  
			
		});
	}
</script>

<div style="padding:50px 80px 10px 80px;">
	<%= @data_update.update_datetime %> 時点
	<div id="div_dummy_02" style="width:100%;height:90%;">
		<table id="building_table"></table>
		<div id = "building_pager"></div>
	</div>
</div>


<div style="margin:50px">
	
	<h3>レンターズ連動</h3> 
	<%= form_tag({:action=>'update_all'}) do %>
	
		
		<%= submit_tag '同期' %>&nbsp;&nbsp;<%= collection_select :batch, :value, @batch_list, :batch_cd, :batch_cd %>&nbsp;&nbsp;最新更新開始：<%= @data_update.start_datetime %>&nbsp;最新更新日時：<%= @data_update.update_datetime %>  更新者：<%= @data_update.biru_user.name if @data_update.biru_user %>
	<% end %>
	
</div>
